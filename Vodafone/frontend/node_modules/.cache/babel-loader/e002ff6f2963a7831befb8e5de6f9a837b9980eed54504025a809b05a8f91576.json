{"ast":null,"code":"import React,{useState,useEffect}from'react';import SimulationCard from'../components/SimulationCard';import ResultModal from'../components/ResultModal';import api from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SimulationPage=_ref=>{let{user}=_ref;const[simulation,setSimulation]=useState(null);const[loading,setLoading]=useState(true);const[showResult,setShowResult]=useState(false);const[result,setResult]=useState(null);const[submitting,setSubmitting]=useState(false);useEffect(()=>{fetchSimulation();},[]);const fetchSimulation=async()=>{try{const params={user_id:user===null||user===void 0?void 0:user.id};const data=await api.getPhishingSimulation(params);setSimulation(data);}catch(error){console.error('Error fetching simulation:',error);}finally{setLoading(false);}};const handleAction=async action=>{const clicked=action!=='safe';const payload={user_id:(user===null||user===void 0?void 0:user.id)||1,simulation_id:simulation===null||simulation===void 0?void 0:simulation.id,clicked};console.log('[SimulationPage] submitting interaction payload:',payload);setSubmitting(true);try{const res=await api.trackPhishingClick(payload);console.log('[SimulationPage] /api/phishing/click response:',res);const isCorrect=res.success===true&&!clicked;setResult({isCorrect,isSafe:!clicked,score:res.new_score,message:res.message});setShowResult(true);}catch(error){console.error('Error submitting interaction:',error);setResult({isCorrect:false,isSafe:!clicked,score:null,message:error&&error.message||'Failed to submit interaction'});setShowResult(true);}finally{setSubmitting(false);}};const handleCloseResult=()=>{setShowResult(false);setResult(null);fetchSimulation();// Load new simulation\n};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-96\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"glassmorphism rounded-xl p-8 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white\",children:\"Loading simulation...\"})]})});}if(!simulation){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-96\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"glassmorphism rounded-xl p-8 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-red-400 text-4xl mb-4\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-white mb-2\",children:\"Error Loading Simulation\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-300 mb-4\",children:\"Unable to load the simulation. Please try again.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchSimulation,className:\"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all duration-200\",children:\"Retry\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-bold text-white mb-4 font-cyber\",children:\"Phishing Simulation\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-300 max-w-2xl mx-auto\",children:\"You've received the following email. Based on your cybersecurity training, decide whether this is safe or unsafe to interact with.\"})]}),/*#__PURE__*/_jsx(SimulationCard,{simulation:simulation,onAction:handleAction}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-8 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"glassmorphism rounded-xl p-6 max-w-2xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-white mb-3\",children:\"\\uD83D\\uDCA1 Tips for Identifying Phishing\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-300\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-red-400\",children:\"Red Flags:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"mt-1 space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Urgent language demanding immediate action\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Suspicious sender email addresses\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Requests for personal information\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Poor grammar and spelling\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-green-400\",children:\"Safe Practices:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"mt-1 space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Verify sender through official channels\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Hover over links before clicking\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Report suspicious emails to IT\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 When in doubt, don't click\"})]})]})]})]})}),/*#__PURE__*/_jsx(ResultModal,{isOpen:showResult,onClose:handleCloseResult,result:result,type:\"simulation\"})]});};export default SimulationPage;","map":{"version":3,"names":["React","useState","useEffect","SimulationCard","ResultModal","api","jsx","_jsx","jsxs","_jsxs","SimulationPage","_ref","user","simulation","setSimulation","loading","setLoading","showResult","setShowResult","result","setResult","submitting","setSubmitting","fetchSimulation","params","user_id","id","data","getPhishingSimulation","error","console","handleAction","action","clicked","payload","simulation_id","log","res","trackPhishingClick","isCorrect","success","isSafe","score","new_score","message","handleCloseResult","className","children","onClick","onAction","isOpen","onClose","type"],"sources":["C:/Users/LENOVO/Documents/Vodafone/Project/frontend/src/pages/SimulationPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport SimulationCard from '../components/SimulationCard';\nimport ResultModal from '../components/ResultModal';\nimport api from '../services/api';\n\nconst SimulationPage = ({ user }) => {\n  const [simulation, setSimulation] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showResult, setShowResult] = useState(false);\n  const [result, setResult] = useState(null);\n  const [submitting, setSubmitting] = useState(false);\n\n  useEffect(() => {\n    fetchSimulation();\n  }, []);\n\n  const fetchSimulation = async () => {\n    try {\n      const params = { user_id: user?.id };\n      const data = await api.getPhishingSimulation(params);\n      setSimulation(data);\n    } catch (error) {\n      console.error('Error fetching simulation:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAction = async (action) => {\n    const clicked = action !== 'safe';\n    const payload = {\n      user_id: user?.id || 1,\n      simulation_id: simulation?.id,\n      clicked,\n    };\n    console.log('[SimulationPage] submitting interaction payload:', payload);\n    setSubmitting(true);\n    try {\n      const res = await api.trackPhishingClick(payload);\n      console.log('[SimulationPage] /api/phishing/click response:', res);\n\n      const isCorrect = res.success === true && !clicked;\n\n      setResult({\n        isCorrect,\n        isSafe: !clicked,\n        score: res.new_score,\n        message: res.message,\n      });\n      setShowResult(true);\n    } catch (error) {\n      console.error('Error submitting interaction:', error);\n      setResult({\n        isCorrect: false,\n        isSafe: !clicked,\n        score: null,\n        message: (error && error.message) || 'Failed to submit interaction',\n      });\n      setShowResult(true);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n\n  const handleCloseResult = () => {\n    setShowResult(false);\n    setResult(null);\n    fetchSimulation(); // Load new simulation\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-96\">\n        <div className=\"glassmorphism rounded-xl p-8 text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400 mx-auto mb-4\"></div>\n          <p className=\"text-white\">Loading simulation...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!simulation) {\n    return (\n      <div className=\"flex items-center justify-center min-h-96\">\n        <div className=\"glassmorphism rounded-xl p-8 text-center\">\n          <div className=\"text-red-400 text-4xl mb-4\">‚ö†Ô∏è</div>\n          <h2 className=\"text-xl font-semibold text-white mb-2\">Error Loading Simulation</h2>\n          <p className=\"text-gray-300 mb-4\">Unable to load the simulation. Please try again.</p>\n          <button\n            onClick={fetchSimulation}\n            className=\"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all duration-200\"\n          >\n            Retry\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen\">\n      <div className=\"text-center mb-8\">\n        <h1 className=\"text-4xl font-bold text-white mb-4 font-cyber\">\n          Phishing Simulation\n        </h1>\n        <p className=\"text-gray-300 max-w-2xl mx-auto\">\n          You've received the following email. Based on your cybersecurity training,\n          decide whether this is safe or unsafe to interact with.\n        </p>\n      </div>\n\n      <SimulationCard\n        simulation={simulation}\n        onAction={handleAction}\n      />\n\n      <div className=\"mt-8 text-center\">\n        <div className=\"glassmorphism rounded-xl p-6 max-w-2xl mx-auto\">\n          <h3 className=\"text-lg font-semibold text-white mb-3\">üí° Tips for Identifying Phishing</h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-300\">\n            <div>\n              <strong className=\"text-red-400\">Red Flags:</strong>\n              <ul className=\"mt-1 space-y-1\">\n                <li>‚Ä¢ Urgent language demanding immediate action</li>\n                <li>‚Ä¢ Suspicious sender email addresses</li>\n                <li>‚Ä¢ Requests for personal information</li>\n                <li>‚Ä¢ Poor grammar and spelling</li>\n              </ul>\n            </div>\n            <div>\n              <strong className=\"text-green-400\">Safe Practices:</strong>\n              <ul className=\"mt-1 space-y-1\">\n                <li>‚Ä¢ Verify sender through official channels</li>\n                <li>‚Ä¢ Hover over links before clicking</li>\n                <li>‚Ä¢ Report suspicious emails to IT</li>\n                <li>‚Ä¢ When in doubt, don't click</li>\n              </ul>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <ResultModal\n        isOpen={showResult}\n        onClose={handleCloseResult}\n        result={result}\n        type=\"simulation\"\n      />\n    </div>\n  );\n};\n\nexport default SimulationPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}